<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Color Collector</title>

    <style>
        html, body{
            height: 100%;
			/*min-height: 100vh;*/
			margin:0;
        }

        #mainContent{
            width: 100%;
            height: 100%;
            /*height: 98.4vh;*/
        }
		
		textarea#info{
			display:inline;
            resize: none;
            background-color: black;
            color:white;
            box-shadow: none;
            border: azure;
            width: 440px;
		}

        #clickies{
            <!-- width: 100%; -->
        }
    </style>

    <script>

        var colors = [];
        // var currentColor = null;
        var currentColorIndex = -1;
        var bodyNode;
        var infoNode;
		
		function updateDropDownColor(){
			const selectNode = document.getElementById("ddBGColor");
			const c = selectNode.children[selectNode.selectedIndex].value.split(" ");
			console.log(c);
			selectNode.style.backgroundColor = c[0];
			selectNode.style.color = c[1];			
		}
		
		function colorSelectChangeFunc(){
			const selectNode = document.getElementById("ddBGColor");
			console.log("Selected option index: " + selectNode.selectedIndex);
			console.log(colors[selectNode.selectedIndex - 1]);
			
			currentColorIndex = selectNode.selectedIndex - 1;
			//updateColor(colors[selectNode.selectedIndex - 1]);
			updateColor(colors[currentColorIndex]);
			
			updateDropDownColor();
		}

        document.addEventListener("DOMContentLoaded", function(){
            bodyNode = document.querySelector("body");
            bodyNode.style.background = "#000";
            infoNode = document.querySelector("textarea#info");
            updateInfo();
            document.querySelector("#ddBGColor").onchange = colorSelectChangeFunc;
        });
		

        function updateInfo(){
            const s = bodyNode.style.background;
			if(currentColorIndex != -1){
				infoNode.textContent = `Index:  + ${currentColorIndex} / ${colors.length-1}\n${colors[currentColorIndex].c1}, ${colors[currentColorIndex].c2}`;
			}
			else{
				infoNode.textContent = `Index:  + ${currentColorIndex} / ${colors.length-1}\n#000, #000`;
			}
        }

        function updateColor(currentColor){
            if(typeof currentColor == "string"){
                bodyNode.style.background = currentColor;
            }
            else{
                bodyNode.style.background = `linear-gradient(${currentColor.c1},${currentColor.c2}) no-repeat`;
            }
			
			updateInfo();
			
        }
		
		function updateDropdown(newIndex, strCommand){
		
            const selectNode = document.getElementById("ddBGColor");
			
			switch(strCommand){
				case "new":
					const option = document.createElement('option');
					option.text = colors[newIndex].c1 + ' - ' + colors[newIndex].c2;
					option.value = colors[newIndex].c1 + ' ' + colors[newIndex].c2;
					//option.onclick = updateColor;
					option.style.backgroundColor = colors[newIndex].c1;
					option.style.color = colors[newIndex].c2;
					//selectNode.add(option, 0);
					selectNode.add(option);
					selectNode.style.background = option.value;
					//selectNode.selectedIndex = selectNode.options[selectNode.options.length - 1];
					selectNode.selectedIndex = newIndex + 1;
					updateDropDownColor();
					break;
					
				case "prev":
				case "next":
					selectNode.selectedIndex = newIndex + 1;
					updateDropDownColor();
					break;
				case "remove":
					//console.log(selectNode.options);
					//console.log(selectNode.length);
					
					if(selectNode.length == 1){
						break;
					}
					
					//selectNode.remove(selectNode.options[selectNode.length-1]);
					selectNode.remove(selectNode.length - 1);
					//selectNode.remove(1);
					
					selectNode.selectedIndex = newIndex + 1;
					
					//if(colors.length == 1){
					//	selectNode.selectedIndex = 0;
					//}
					
					if(selectNode.length == 1){
						selectNode.style.backgroundColor = "#fff";
						selectNode.style.color = "#000";
					}					
					
					updateDropDownColor();
					
					break;
			}
		}

        function newColor(){
            colors.push({
                name: '',
                c1 : '#' + (Math.random() * 0xFFFFFF << 0).toString(16).padStart(6, '0'),
                c2 : '#' + (Math.random() * 0xFFFFFF << 0).toString(16).padStart(6, '0')
            });
            currentColorIndex = colors.length - 1;
            updateColor(colors[currentColorIndex]);
			updateDropdown(currentColorIndex,"new");
			// console.log("Index: " + currentColorIndex);
        }

        function prevColor(){
            if(colors.length !== 0){
				currentColorIndex = (currentColorIndex !== 0 ? --currentColorIndex : colors.length-1) % colors.length;
                updateColor(colors[currentColorIndex]);
                // console.log("Index: " + currentColorIndex);
				updateDropdown(currentColorIndex, "prev");
            }
        }

        function nextColor(){
            if(colors.length !== 0){
				//currentColorIndex = ++currentColorIndex % colors.length;
				currentColorIndex = (currentColorIndex === colors.length-1 ? 0 : ++currentColorIndex) % colors.length;
                updateColor(colors[currentColorIndex]);
                // console.log("Index: " + currentColorIndex);
				updateDropdown(currentColorIndex, "next");
            }
        }

        function deleteColor(){
            colors.pop();
            if(colors.length !== 0){
				if(currentColorIndex === colors.length){
					prevColor();
				}
				updateInfo();
				//updateDropdown(currentColorIndex, "remove");
            }else{
				currentColorIndex = -1;
                updateColor("#000");
				//updateDropdown(-1, "remove");
            }
			updateDropdown(currentColorIndex, "remove");
        }
		
		function deleteSelectedColor(){}

    </script>

</head>
<body>

<div id="mainContent">
    <div id="clickies">
        <label for="info"></label><textarea id="info" readonly="readonly"></textarea>
		<button onclick="prevColor()">Previous Color</button>
		<button onclick="newColor()">New Color!</button>
		<button onclick="nextColor()">Next Color</button>
		<button onclick="deleteColor()">Delete Last Color</button>
		<select id="ddBGColor" name="ddTextColor" class="btn dropdown-toggle" style="font-weight: bold;">
			<option hidden="hidden">Select Background Color</option>
		</select>
		<button onclick="deleteSelectedColor()">Delete Selected Color</button>
	</div>
</div>

</body>
</html>